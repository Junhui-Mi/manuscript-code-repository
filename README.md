# Manuscript code repository

This repository contains statistical code and data related to peer-reviewed published manuscripts. The goal is to increase transparency and reproducibility in research.

***

## Eaton-Zabor_Interval-RFS-sim-study

Files:

- `fn-create-single-dataset.R` function to simulate a single interval censored dataset
- `fn-fit-models.R` function to fit each of the models included in the paper
- `fn-tidy-ic_sp.R` helper function to tidy the results from icenReg::ic_sp() function
- `program1-run-simulation.R` program to run a simulation for a given scenario and summarize results

Instructions:
1. Download all files to the same directory
2. Open `program1-run-simulation.R`
3. Install the `cwcens` package in R from `remotes::install_github("anneae/cwcens")`
4. Either set your working directory or alter the file paths for the 3 function files in the section "Load functions"
5. Change the parameters of interest in the section "Generate many datasets", including possibly the number of simulated datasets and the seed
6. In the section "Prepare data to summarize" you will need to change the truth to appropriately match the setting you are examining. In the example the HR for both recurrence and death were set to 1.5 so the true log HR in all cases is log(1.5)
7. Run all code in the file to fit the models and summarize the results with a boxplot and table


## Zabor_Basket-Trial-with-FDR-Control

This paper contains three distinct parts:

1. Model calibration
    - `heterogeneous_response_sim_fn.R` A function to run the basket trial with different design parameters
    - `heterogeneous_response_sim_do.R` A function that implements `heterogeneous_response_sim_fn.R` for the design parameters of interest
    - `heterogeneous_response_sim_res.rda` The simulation results from `heterogeneous_response_sim_do.R`
    - `heterogeneous_response_sim_report.Rmd` R Markdown report to summarize the results in `heterogeneous_response_sim_res.rda`
    
2. Case study
    - `neratinib_mem_test.R` The program to generate simulation results based on the neratinib case study
    - `nerat_basket_0.25.rda` and `nerat_basket_0.5.rda` are two files of simulation results generated by `neratinib_mem_test.R` for different prior probabilities of exchangeability
    - `neratinib_mem_results.Rmd` R Markdown report to summarize the results in `nerat_basket_0.25.rda` and `nerat_basket_0.5.rda`
    
3. Trial operating characteristics
    - `do_single_sim.R` A function to generate MEM and frequentist results for baskets with given sample sizes and true response rates
    - `scenario1-alt0.R` Executes the global alternative scenario
    - `scenario1-alt0.rda` Results from `scenario1-alt0.R`
    - `scenario1-alt1.R` Executes alternative 1 scenario
    - `scenario1-alt1.rda` Results from `scenario1-alt1.R`
    - `scenario1-alt2.R` Executes alternative 2 scenario
    - `scenario1-alt2.rda` Results from `scenario1-alt2.R`
    - `scenario1-alt3.R` Executes alternative 3 scenario
    - `scenario1-alt3.rda` Results from `scenario1-alt3.R`
    - `scenario1-null.R` Executes the global null scenario
    - `scenario1-null.rda` Results from `scenario1-null.R`
    - `operating-chars-results.R` Gets summary dataframes of the results from the `scenario1-****.rda` files
    - `scenario1-summary.rda` Summary results from `operating-chars-results.R`
    - `operating-chars-results-report.Rmd` R Markdown report to summarize the results in `scenario1-summary.rda`
    
*Please note that these files were organized in an elaborate folder structure with a top-level R project and all filepaths used `here::here` relative to the R project. Please alter the filepaths accordingly.*

***

## Zabor_Validity-of-a-method-for-etiologic-heterogeneity

Files:

- `eh_cluster_sim_fun.R` contains the primary function for conducting a clustering simulation
- `run_eh_cluster_sim_fun.R` is where you can set the simulation parameters to desired values and run the simulation

Instructions:

1. Download both files to the same directory
2. Install the `riskclustr` package from CRAN using `install.packages("riskclustr")`. Note that this line of code is commented out in `eh_cluster_sim_fun.R` as it only needs to be run once.
3. Change the filepath in `setwd()` in `run_eh_cluster_sim.R`to point to the directory where the files were downloaded
4. Set simulation parameters in `run_eh_cluster_sim.R` to desired values 
5. Use `set.seed()` to set a seed. Note that a variety of seeds were used to produce results in the manuscript.
6. Run `run_eh_cluster_sim.R` to produce results. See notes at bottom of code file for details on results structure.
